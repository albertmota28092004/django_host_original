{% extends 'tienda/base.html' %}
{% load static %}
{% load humanize %}
{% block title %}Productos{% endblock %}
{% block contenedor %}

<a class="btn btn-light m-2 crear_formulario" href="{% url 'tienda:productos_formulario' %}" ><i class="bi bi-plus-lg" style="font-size: 23px;"></i></a>

<table class="tablas_modulos table table-striped">
    <thead class="encabezados_tablas">
        <th>ID</th>
        <th>Foto</th>
        <th>Nombre</th>
        <th>Descripción</th>
        <th class="text-end">Precio</th>
        <th>Fecha Compra</th>
        <th>Stock</th>
        <th>Categoría</th>
        <th>Acciones</th>
        <th>
            <form class="d-flex" role="search" method="post" action="{% url 'tienda:productos_buscar' %}" style="">
                {% csrf_token %}
                <a href=""><i class="btn btn-dark bi bi-arrow-counterclockwise" style="color: white;"></i></a>
                <input class="form-control buscar_tablas" type="search" placeholder="Buscar" aria-label="Search" name="buscar"
                       value="{{ buscado }}">
                <button class="btn btn-dark" type="submit"><i class="bi bi-search"></i></button>
            </form>
        </th>
    </thead>
    {% if data %}
        {% for i in data %}
        <tr>
            <td>{{ i.id }}</td>
            <td class="portfolio-item image-zoom">
                <a href="{{ i.foto.url }}" data-fancybox="gallery">
                    <img class="img-fluid img-portfolio" alt="Panning picture #1" src="{{ i.foto.url }}" width="100px">
                </a>
            </td>
            <td>{{ i.nombre }}</td>
            <td>
                <div style="overflow-y: scroll; width: 300px !important;">
                    {{ i.descripcion }}
                </div>

            </td>
            <td class="text-end">${{ i.precio|intcomma }}</td>
            <td>{{ i.fecha_compra }}</td>
            <td>{{ i.stock }}</td>
            <td>{{ i.categoria }} </td>
            <td>
                <a href="{% url 'tienda:productos_editar' i.id %}" class="btn btn-info"><i class="bi bi-pencil-fill"></i></a>
                <a href="javascript:confirmar_eliminar('{{ i.id }}', '{% url 'tienda:productos_eliminar' i.id %}');"
                   class="btn btn-danger"><i class="bi bi-trash3-fill"></i></a>
            </td>
            <td></td>
        </tr>
        {% endfor %}
     {% else %}
        <td>No hay registros...</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    {% endif %}
</table>
<script>
    function confirmar_eliminar(id, url) {
        if (confirm("¿Estás seguro de que deseas eliminar este pedido?")) {
            window.location.href = url;
        }
    }

    $(document).ready(function() {
        $('#tabla-categorias').DataTable();
    });
</script>

</body>
</html>

{% endblock %}